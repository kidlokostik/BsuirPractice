<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

    <changeSet id="v3-1" author="Katya Pechko, Kirill Pavlov">
        <renameColumn tableName="OrderItems" oldColumnName="orderitems_id" newColumnName="id"></renameColumn>
    </changeSet>

    <changeSet id="v3-2" author="Urbanait Konstantin">
        <addForeignKeyConstraint baseTableName="OrderItems"
                                 baseColumnNames="product_id"
                                 constraintName="fk_Orderitems_Products"
                                 referencedTableName="products"
                                 referencedColumnNames="id"
                                 onDelete="CASCADE"
                                 onUpdate="CASCADE"/>
    </changeSet>

    <changeSet id="v3-3" author="Urbanait Konstantin">
        <addForeignKeyConstraint baseTableName="OrderItems"
                                 baseColumnNames="order_id"
                                 constraintName="fk_Orderitems_new_Orders"
                                 referencedTableName="orders"
                                 referencedColumnNames="id"
                                 onDelete="CASCADE"
                                 onUpdate="CASCADE"/>
    </changeSet>

    <changeSet id="v3-4" author="Katya Pechko, Kirill Pavlov">
        <renameTable catalogName="tables" schemaName="public" oldTableName="OrderItems" newTableName="order_items"/>
    </changeSet>

</databaseChangeLog>